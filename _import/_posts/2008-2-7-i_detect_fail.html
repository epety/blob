--- 
layout: post
title: I Detect FAIL.
mt_id: 6
---
At <a href="http://www.uncov.com/">Uncov</a>, I took a lot of time to write about fail.&nbsp; For lack of a better word, I described the horrific ignorance of reason and systemic absence of programming ability that runs rampant in Web 2.0 simply as <b>fail</b>.<br /><br />While developing <a href="http://www.persai.com/">Persai</a>, we have furthered the study of fail, and developed it into a management tool.<br /><br /><font style="font-size: 1.25em;"><b>The Failboard</b></font><br /><br />My two cofounders and I started a failboard where we keep tallies of eachother's fail.&nbsp; A whiteboard, a dry erase marker, and unrelenting fits of ball-busting are all you need to implement this strategy at your organization.<br /><br />When one member of your team fails at something, it is tallied on the board.&nbsp; The other members of the team then harass the failer about his programming ability, sexual prowess, and general competence.<br /><br /><font style="font-size: 1.25em;"><b>The Grand Unified Theory of Fail</b></font><br /><br />What <i>is</i> fail?&nbsp; What does a person have to do to deserve this treatment?&nbsp; It has no formal definition, but loosely, a fail is some bit of negligence, misunderstanding, unwillingness to read documentation, or just plain unforgivable stupidity that leads to a problem.&nbsp; Fail is amplified by the magnitude of the problem and the ease with which the error could have been detected.<br /><br />For example, pushing a CSS change to a production website that doesn't quite work in IE is not a fail because it's just some lame HTML problem.&nbsp; There's no gap in understanding here, it's just programmer laziness, or aversion to busywork.<br /><br /><font style="font-size: 1.25em;"><b>Anatomy of a Fail</b></font><br /><br />I will pull an example of something that <i>is</i> a fail from my experience with Persai.&nbsp; This fail was my own, and my balls were busted within an inch of their lives in retribution.<br /><br />We keep vectors in a sparse format to conserve memory, because most of the elements are zeroes.&nbsp; Iteration on these sparse vectors requires some tricky bookkeeping of indices, but if you're paying attention, it's not that hard.<br /><br />I was writing a simple math library for our sparse vector format.&nbsp; The first method I wrote was a dot product, and it performed admirably.&nbsp; If you're not familiar with the dot product, it's the sum of the products of the vector elements.&nbsp; So, if you have a zero in some position in <i>one</i> of the vectors, it's not even worth your time to carry through the multiplication with the other vector if it has a nonzero element in that position, because it adds nothing to the sum.<br /><br />Because of this, you can play fast and loose with the bookkeeping in a dot product.&nbsp; I hammered this method down, and had gotten the general idea of how to iterate over two sparse vectors and match up the indices.<br /><br />The next method I went to write was a vector sum.&nbsp; Since I had gotten the bookkeeping right in the dot product method, I copied-and-pasted the loop from <code>dotprod()</code> to <code>sum()</code>.&nbsp; Copy-paste is strongly correlated with fail.<br /><br />Of course, I never unit tested this, just rolled it out.&nbsp; <i>I know what I'm doing.&nbsp; I've got a degree in math.&nbsp; How could I possibly screw this up?</i>&nbsp; A vector sum is a pretty fundamental operation, and many other higher-level vector math operations we use depend on it.&nbsp; Namely, there's some complicated math behind how we bootstrap a recommendation system based on relatively little signal.&nbsp; I had pushed this new library out to our development setup and just assumed it worked.<br /><br />I created a new Persai interest about Facebook, seeding it with the word "facebook".&nbsp; It started giving recommendations about pasta recipes.&nbsp; I tried to pass the blame off to my co-founders, trying to come up with some cock-and-bull story about how the documents are parsed and so on.&nbsp; I dug into the code a little bit, down through the math, and had that moment of realization: I had failed.&nbsp; Usually, you can tell when a teammate fails because they will be looking at an Eclipse screen and just out of the blue mutter <i>"Oh good Lord"</i>.<br /><br />Remember that whole bit about being able to skip the multiply when a vector has a zero in that position?&nbsp; That doesn't work with addition, because even though 0x = 0, it turns out that 0 + x = x, not zero.&nbsp; FAIL.<br /><br />This error was inexcusable, and I paid dearly for it, mostly with pride.<br /><font style="font-size: 1.25em;"><b><br />The Failboard in Practice</b></font><br /><br />After a while using the failboard, you start to get a sixth sense for fail.&nbsp;&nbsp; Some code path that makes use of a <code>synchronized()</code> block is slowing down at odd times? A bit of UTF-8 encoded text goes through a couple of programs and comes out garbled?  <code>ConcurrentModificationException</code>?&nbsp; The sources of these problems will shortly end up as tallies on the board.<br /><br />It gets more powerful when you can preemptively detect fail, not in your own code, but in your teammates'.&nbsp; Believe me, if you punish teammates severely enough, it will happen less, because everyone develops a nose for fail.<br /><br /><br /> 
